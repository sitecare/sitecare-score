<?php

namespace Sitecare;

class Scan
{

    public function __construct()
    {
    }

    public function init(): void
    {

        $email_report = false;
        if (!empty($_REQUEST['email_report'])) {
            $email_report = sanitize_key($_REQUEST['email_report']);
        }

        $settings = [
            'email_report' => $email_report,
            'email' => sanitize_email($_REQUEST['email']),
        ];

        update_option('sitecare_scan_settings', $settings);

        ?>

        <div class="sitecare-scan" style="text-align: center;">

            <div class="mark">
                <svg width="84" height="84" viewBox="0 0 84 84" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21.133 66.3146C23.3575 66.3146 25.582 66.3146 27.8066 66.3146C27.8066 66.5561 27.8066 66.7498 27.8066 66.9913C27.8066 69.6477 27.8066 72.3037 27.8066 75.0084C27.8066 76.3608 28.7254 77.3268 30.1278 77.3268C38.1071 77.3268 46.0864 77.3273 54.0173 77.279C55.468 77.279 56.3869 76.3125 56.3869 74.9118C56.3869 72.2071 56.3385 69.5506 56.4352 66.8459C56.5803 61.7745 60.6425 57.2348 65.6235 56.5103C67.0743 56.3171 68.5734 56.3171 70.0725 56.2688C71.7168 56.2205 73.4093 56.2688 75.0535 56.2688C76.5043 56.2688 77.4231 55.3511 77.4231 53.8539C77.4231 45.9811 77.4231 38.1083 77.4231 30.187C77.4231 28.6897 76.5527 27.7721 75.1019 27.6755C74.9568 27.6755 74.7634 27.6755 74.6183 27.6755C64.3178 27.6755 54.0656 27.6755 43.7651 27.6755C42.5078 27.6755 41.2988 27.7721 40.0898 28.3033C38.3972 29.0278 37.1883 30.2353 36.9465 32.167C36.7047 34.0507 37.5751 35.548 39.0259 36.6589C40.38 37.7214 42.0242 38.0595 43.7168 38.3493C47.5855 39.0255 51.2124 40.3784 54.114 43.0831C56.532 45.3532 57.9344 48.0575 57.7893 51.4867C57.6442 54.5779 56.1451 57.0416 53.8238 59.0219C51.1641 61.2437 48.0207 62.3058 44.6839 62.7404C43.1848 62.9336 41.6857 62.9819 40.1865 62.9819C28.8705 62.9819 17.5544 62.9819 6.23834 62.9819C2.65975 62.9819 0 60.3255 0 56.7996C0 46.9466 0 37.0936 0 27.2408C0 23.6666 2.75648 21.0102 6.38342 21.0585C9.81693 21.1068 13.2504 21.1068 16.6356 21.0585C19.0535 21.0585 20.9879 18.9816 20.9879 16.5666C20.9879 13.0408 20.9879 9.51495 20.9879 5.94081C21.0363 2.80136 23.5993 0.193198 26.7427 0.0483003C26.9361 0.0483003 27.1779 0 27.3713 0C37.2366 0 47.1019 0 56.9672 0C60.1105 0 62.867 2.55986 62.9154 5.69931C63.0121 9.61155 62.9154 13.4755 62.9154 17.3877C62.9154 17.4843 62.9154 17.5326 62.867 17.6775C60.6908 17.6775 58.5147 17.6775 56.2418 17.6775C56.2418 17.436 56.1934 17.1945 56.1934 17.0013C56.1934 14.4415 56.1934 11.8816 56.1934 9.27345C56.1934 7.58298 55.323 6.71359 53.6304 6.71359C45.8929 6.71359 38.1071 6.71359 30.3696 6.71359C30.0794 6.71359 29.8377 6.71359 29.5475 6.76189C28.3869 6.95509 27.6131 7.82447 27.6131 8.98366C27.6131 11.6401 27.6615 14.2966 27.5648 16.9047C27.4197 22.5074 23.019 27.1925 17.4093 27.6272C14.6529 27.8204 11.8964 27.7238 9.18826 27.6755C7.73748 27.6272 6.62522 28.5931 6.62522 30.0421C6.62522 38.0112 6.62522 45.9806 6.62522 53.9983C6.62522 55.3507 7.54404 56.2688 8.8981 56.2688C19.6339 56.2688 30.3212 56.2688 41.057 56.2688C42.3627 56.2688 43.62 55.979 44.7323 55.3028C47.5855 53.5641 47.924 49.9412 45.4093 47.7194C44.152 46.6085 42.6045 46.0772 40.9603 45.7874C37.5751 45.2561 34.3834 44.2423 31.5302 42.2621C29.1606 40.6199 27.2746 38.4942 26.5009 35.6446C25.4853 31.9255 26.5009 28.6897 29.1123 25.9367C31.4819 23.4251 34.5285 22.0727 37.8653 21.4932C39.7997 21.1551 41.734 20.9619 43.7168 20.9619C54.8877 20.9136 66.0104 20.9619 77.1814 20.9136C78.9706 20.9136 80.4698 21.3966 81.8238 22.4591C83.2746 23.6183 84 25.1639 84 26.9993C84 36.9974 84 46.9466 84 56.9445C84 60.2772 81.2435 62.9819 77.9067 62.9819C74.5216 62.9819 71.0881 62.9819 67.7029 62.9819C65.3817 62.9819 63.5924 64.3826 63.0604 66.4595C62.9637 66.8942 62.9154 67.3776 62.9154 67.8606C62.9154 71.145 62.9154 74.4776 62.9154 77.762C62.9154 81.2878 60.2556 83.9438 56.7254 83.9438C48.0207 83.9438 39.3161 83.9921 30.6114 83.9921C29.1123 83.9921 27.6615 84.0409 26.1623 83.896C23.3575 83.6545 20.9396 81.0463 20.8912 78.245C20.8428 74.3327 20.8912 70.4683 20.8912 66.5561C21.0846 66.5078 21.133 66.4112 21.133 66.3146Z"
                          fill="#0062FF"/>
                </svg>
            </div>

            <div class="text">
                <?php esc_html_e("Your website scan is underway. We'll have your SiteCare Score ready for you in a flash!", 'sitecare-score') ?>
            </div>

            <div class="subtext">
                <?php esc_html_e('A thorough check-up takes a little time. Thanks for hanging tight!', 'sitecare-score') ?>
            </div>

            <div class="loader-bar-container">
                <svg class="ip" viewBox="0 0 256 128" width="256px" height="128px" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="grad1" x1="0" y1="0" x2="1" y2="0">
                            <stop offset="0%" stop-color="#1A71FF"/>
                            <stop offset="50%" stop-color="#994CDA"/>
                            <stop offset="100%" stop-color="#FF2EBD"/>
                        </linearGradient>
                        <linearGradient id="grad2" x1="1" y1="0" x2="0" y2="0">
                            <stop offset="0%" stop-color="#FF2EBD"/>
                            <stop offset="50%" stop-color="#994CDA"/>
                            <stop offset="100%" stop-color="#1A71FF"/>
                        </linearGradient>
                    </defs>
                    <g fill="none" stroke-linecap="round" stroke-width="16">
                        <g class="ip__track" stroke="#ddd">
                            <path d="M8,64s0-56,60-56,60,112,120,112,60-56,60-56"/>
                            <path d="M248,64s0-56-60-56-60,112-120,112S8,64,8,64"/>
                        </g>
                        <g stroke-dasharray="180 656">
                            <path class="ip__worm1" stroke="url(#grad1)" stroke-dashoffset="0"
                                  d="M8,64s0-56,60-56,60,112,120,112,60-56,60-56"/>
                            <path class="ip__worm2" stroke="url(#grad2)" stroke-dashoffset="358"
                                  d="M248,64s0-56-60-56-60,112-120,112S8,64,8,64"/>
                        </g>
                    </g>
                </svg>
            </div>

            <div
                    id="status-text"
                    class="status-text"
            >
                <?php esc_html_e('Initializing scan', 'sitecare-score') ?>
            </div>

        </div>

        <?php

    }

}
